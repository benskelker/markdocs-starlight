<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../Resources/TableStyles/Standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/Standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../Resources/TableStyles/Standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
    </head>
    <body>
        <map id="map2">
            <area shape="rectangle" coords="344,190,954,368" dragDirection="0" href="#Download" />
            <area shape="rectangle" coords="336,452,622,642" dragDirection="0" href="#Configur" />
            <area shape="rectangle" coords="350,720,628,908" dragDirection="0" href="#Set" />
            <area shape="rectangle" coords="668,720,942,910" dragDirection="0" href="#ServiceN" />
            <area shape="rectangle" coords="1306,724,1574,906" dragDirection="0" href="#Set" />
            <area shape="rectangle" coords="1622,720,1896,910" dragDirection="0" href="#Assign" />
            <area shape="rectangle" coords="2066,692,2340,888" dragDirection="0" href="#snow-verify" />
            <area shape="rectangle" coords="826,986,1108,1172" dragDirection="0" href="#admin:" />
            <area shape="rectangle" coords="1152,984,1416,1174" dragDirection="0" href="#Set2" />
            <area shape="rectangle" coords="344,1256,622,1444" dragDirection="0" href="#Delegate" />
        </map>
        <h1><a name="Configur2"></a>Configure approval channel - ServiceNow</h1>
        <p>This topic describes how to integrate ServiceNow with <MadCap:variable name="cc_product_vars.SCA-short" /> so that ServiceNow can serve as your approval channel for on&#8209;demand access requests to your cloud workspace.</p>
        <h2>ServiceNow support</h2>
        <p>This integration supports ServiceNow Washington D.C. and later releases.</p>
        <h2>Before you begin</h2>
        <p>Before you set up the integration between <MadCap:variable name="cc_product_vars.SCA-short" /> and ServiceNow, complete the steps described in <MadCap:xref href="sca_on-demand-access-settings.htm">Set up on-demand access</MadCap:xref>, the last of which brings you back to this topic to complete the approval channel configuration.</p>
        <p>To support communication with ServiceNow, <MadCap:variable name="cc_product_vars.Flows-short" /> must be enabled in your <MadCap:variable name="cc_C_CyberArk.CompanyName" /> tenant. A <span class="Emphasis">Flows Executor</span> role is sufficient for granting on-demand access. </p>
        <h2><a name="ServiceN2"></a><a name="snow-setup"></a>ServiceNow configuration - Workflow</h2>
        <p>This section gives you an outline of the steps needed to set up ServiceNow as your approval channel.</p>
        <p>This is a multi-admin effort. Some tasks require <MadCap:variable name="cc_C_CyberArk.CompanyName" /> admin roles for <MadCap:variable name="cc_product_vars.CEM-short" />, <MadCap:variable name="cc_product_vars.SCA-short" />, and <MadCap:variable name="cc_product_vars.Flows-short" />, and some require the ServiceNow admin role in ServiceNow.</p>
        <div class="important">
            <p>The interconnecting lines indicate dependencies, meaning that a step with an arrow pointing into it is dependent on the completion of the step before it.</p>
        </div>
        <p>
            <img src="images/sca-snow-workflow.png" usemap="#map1" class="Enlarge" />
        </p>
        <ol>
            <li>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot><a name="Download"></a><MadCap:variable name="cc_C_CyberArk.CompanyName" /> admin: Download the <MadCap:variable name="cc_product_vars.SCA-short" /> pre-defined flows</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <p>In this step you download <MadCap:variable name="cc_product_vars.Flows-short" /> flows that you will need later in this set up. </p>
                        <p>For more information about each of these flows and what they do, see <MadCap:xref href="#snow-flows">[%=cc_C_CyberArk.CompanyName%] admin: Set up the On-demand access flows</MadCap:xref> later on in this procedure.</p>
                        <p><a name="From"></a><span class="Emphasis">In <MadCap:variable name="cc_product_vars.SCA-short" />:</span>
                        </p>
                        <ol>
                            <li>
                                <p>Go to <span class="Emphasis">Settings &gt; On-demand access &gt; Approval channel</span> , and select <span class="Emphasis">ServiceNow</span>.</p>
                            </li>
                            <li>
                                <p> Click the link to download the <span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" />-Ondemand-ServiceNow-Flows</span> archive file containing pre-defined flows (JSON files) for the <MadCap:variable name="cc_product_vars.SCA-short" /> - ServiceNow integration. </p>
                                <div class="note" MadCap:conditions="cc_C_CyberArk.Future">
                                    <p>This archive file is also available from the CyberArk Marketplace's <a href="https://community.cyberark.com/marketplace/s/#a35Ht000001phb7IAA-a39Ht000004Dfl3IAC" target="_blank" alt="Link to the CyberArk Marketplace" title="Link to the CyberArk Marketplace">SCA Ondemand via ServiceNow integration</a> page.</p>
                                </div>
                            </li>
                            <li>
                                <p>Unzip the file into a local directory. The flows, which you will need later, are contained in this archive file:</p>
                                <div class="important">
                                    <p>Don't change the names of the JSON files when you unzip them. If you change a file name, this will break the flow and the feature won't work as expected.</p>
                                </div>
                            </li>
                        </ol>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot><a name="Configur"></a><MadCap:variable name="cc_C_CyberArk.CompanyName" /> admin: Configure authentication for <MadCap:variable name="cc_product_vars.SCA-full" /> in <MadCap:variable name="cc_product_vars.IdentityAdmin-full" /></MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <div class="note">
                            <p>If you have already set up the <MadCap:variable name="cc_C_CyberArk.CompanyName" /> <MadCap:variable name="cc_product_vars.SCA-short" /> API authentication described in <MadCap:xref href="sca_on-demand-access-settings.htm#Configur">Configure on-demand access in [%=cc_product_vars.IdentityAdmin-full%]</MadCap:xref>, you can skip this step.</p>
                        </div>
                        <p>In <MadCap:variable name="cc_product_vars.IdentityAdmin-full" />, enable <MadCap:variable name="cc_product_vars.SCA-short" /> in the integration settings and make sure that you have a custom OAuth2 server so that <MadCap:variable name="cc_C_CyberArk.CompanyName" /> can authenticate to the ServiceNow.</p>
                        <ol>
                            <li>
                                <p><span class="Emphasis">Enable <MadCap:variable name="cc_product_vars.SCA-short" /> in <MadCap:variable name="cc_product_vars.IdentityAdmin-full" /></span>
                                </p>
                                <p>In <MadCap:variable name="cc_product_vars.IdentityAdmin-full" />, go to <span class="Emphasis">Settings </span>&gt; <span class="Emphasis">Integration</span> &gt; <span class="Emphasis">Secure Cloud Access</span>, and select <span class="Emphasis">Users can request permission to add SCA-enabled applications</span>.</p>
                            </li>
                            <li>
                                <p class="step"><span class="Emphasis">Create a custom OAuth2 server</span>
                                </p>
                                <MadCap:snippetBlock src="../DPAforCloud/SCA-snippets/sca-oauth2-server-app.flsnp" MadCap:conditionTagExpression="include[snippet-conditions-sca.oauth2-for-appr-chnl], exclude[snippet-conditions-sca.oauth2-for-api]" />
                            </li>
                            <li>
                                <p class="step"><span class="Emphasis">Create a service user</span>
                                </p>
                                <p>If you don't already have a service user set up for <MadCap:variable name="cc_product_vars.SCA-short" />, set one up now. You need this user to configure <MadCap:variable name="cc_product_vars.SCA-short" /> authorization later in <MadCap:variable name="cc_product_vars.Flows-short" />.</p>
                                <MadCap:snippetBlock src="../DPAforCloud/SCA-snippets/sca-oauth2-server-app-user.flsnp" MadCap:conditionTagExpression="include[snippet-conditions-sca.oauth2-for-appr-chnl], exclude[snippet-conditions-sca.oauth2-for-api]" />
                            </li>
                            <li>
                                <p class="step"><span class="Emphasis">Associate the service user with [%=cc_product_vars.SCA-short%]</span>
                                </p>
                                <MadCap:snippetBlock src="../DPAforCloud/SCA-snippets/sca-oauth2-server-app-permissions.flsnp" MadCap:conditionTagExpression="include[snippet-conditions-sca.oauth2-for-appr-chnl], exclude[snippet-conditions-sca.oauth2-for-api]" />
                            </li>
                        </ol>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot>ServiceNow admin: Install the <MadCap:variable name="cc_C_CyberArk.CompanyName" /> <MadCap:variable name="cc_product_vars.SCA-short" /> app in ServiceNow<a name="Set"></a></MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <p>You must be a ServiceNow admin to configure the <MadCap:variable name="cc_product_vars.SCA-short" /> app in ServiceNow.</p>
                        <p>To enable communication between <MadCap:variable name="cc_product_vars.SCA-short"></MadCap:variable> and ServiceNow, install the <span class="Emphasis">CyberArk <MadCap:variable name="cc_product_vars.SCA-full"></MadCap:variable> On-Demand Workflow</span> app in your ServiceNow tenant. This app is available in the <a href="https://store.servicenow.com/sn_appstore_store.do#!/store/application/2cfe5bae87927510dea3da083cbb359f" alt="Link to the ServiceNow Store" title="Link to the ServiceNow Store" target="_blank">ServiceNow Store</a>.</p>
                        <p>For details on installing the app in ServiceNow, see the <a href="https://docs.servicenow.com/bundle/vancouver-application-development/page/build/applications/task/t_InstallApplications.html" alt="Link to topic in the ServiceNow docs that describes how to install an app from the ServiceNow store">ServiceNow docs</a>.</p>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot><a name="ServiceN"></a>ServiceNow admin: Configure authentication for <MadCap:variable name="cc_product_vars.SCA-full" /> in ServiceNow</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <p>In this step you add an OAuth2 client application to the ServiceNow Application Registry.</p>
                        <ol>
                            <li>
                                <p>In ServiceNow, create an <span class="Emphasis">OAuth application user</span> and give it the <span class="Emphasis">x_cya_cyberark_sca.cyberark_sca_requests_staging_user</span> role. This role came with the <MadCap:variable name="cc_product_vars.SCA-short" /> app that you installed in ServiceNow in the previous step.</p>
                            </li>
                            <li>
                                <p>In ServiceNow, create the OAuth2 client application. Include the <span class="Emphasis">OAuth Application User</span> reference field, and use the OAuth application user you just created as the value for this field.</p>
                                <div class="tip">
                                    <p>For helpful information about creating OAuth client applications, read this <a href="https://www.servicenow.com/community/developer-blog/up-your-oauth2-0-game-inbound-client-credentials-with-washington/ba-p/2816891">knowledge base article</a> in the ServiceNow Community.</p>
                                </div>
                            </li>
                        </ol>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot><a name="admin:"></a><MadCap:variable name="cc_C_CyberArk.CompanyName" /> admin: Test the <MadCap:variable name="cc_C_CyberArk.CompanyName" /> and ServiceNow authentications</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <p>In this step, you authorize each of the authentications you set up for <a href="sca_on-demand-access-settings.htm#Create-CA-oauth2serverapp"><MadCap:variable name="cc_C_CyberArk.CompanyName" /></a> and <a href="#ServiceN">ServiceNow</a>.</p>
                        <ol>
                            <li>
                                <p class="stepReset"><span class="Emphasis">Open <MadCap:variable name="cc_product_vars.Flows-short" /></span>
                                </p>
                                <ol>
                                    <li>
                                        <p>From the <MadCap:variable name="cc_product_vars.ISP-short" /> service picker, open <MadCap:variable name="cc_product_vars.Flows-short" />.</p>
                                    </li>
                                    <li>
                                        <p>Under <span class="Emphasis">Settings</span>, select <span class="Emphasis">Authorizations</span>.</p>
                                    </li>
                                </ol>
                            </li>
                            <li>
                                <p class="step"><span class="Emphasis">Authorize the authentication for ServiceNow</span>
                                </p>
                                <ol>
                                    <li>
                                        <p>In the <span class="Emphasis">Manage Authorizations</span> windows, click <span class="Emphasis">New authorizations</span> and provide the authorization details that you defined in the service account in ServiceNow:</p>
                                        <table style="mc-table-style: url('../Resources/TableStyles/Standard.css');caption-side: top;" class="TableStyle-Standard" cellspacing="0" summary="Lists the ServiceNow information that has to be applied to the authorization">
                                            <caption>ServiceNow authorization details</caption>
                                            <col class="TableStyle-Standard-Column-Column1" />
                                            <col class="TableStyle-Standard-Column-Column1" />
                                            <thead>
                                                <tr class="TableStyle-Standard-Head-Header1">
                                                    <th class="TableStyle-Standard-HeadE-Column1-Header1">
                                                        <p>Item</p>
                                                    </th>
                                                    <th class="TableStyle-Standard-HeadD-Column1-Header1">
                                                        <p>Description</p>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Name</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p>The OAuth2 server name</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Type</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p><span class="Emphasis">OAuth2</span>
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Flow</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p><span class="Emphasis">Client credentials</span>
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Content Type</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p><span class="Emphasis">application/x-www-form-urlencoded</span>
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Client ID</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p>The client ID from <span class="Emphasis">ServiceNow OAuth </span>&gt; <span class="Emphasis">Application Registry</span></p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Client Secret</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p>The client secret from <span class="Emphasis">ServiceNow OAuth </span>&gt; <span class="Emphasis">Application Registry</span></p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1" MadCap:conditions="cc_C_CyberArk.Removed">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">UserID</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p>The user ID&#160;for the service account defined in ServiceNow that the integration will use to invoke the REST API calls</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1" MadCap:conditions="cc_C_CyberArk.Removed">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Password</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p>The password for the service account</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Token URL</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p><span class="Emphasis">https://&lt;instance&gt;.service-now.com/oauth_token.do</span>
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyB-Column1-Body1">
                                                        <p><span class="Emphasis">Scopes</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyA-Column1-Body1">
                                                        <p>(Optional) Select <span class="Emphasis">Scopes</span>, and add scopes to limit the authentication.</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </li>
                                    <li>
                                        <p>Click <span class="Emphasis">Authorize</span>.</p>
                                    </li>
                                    <li>
                                        <p>If the authentication is successful, save the settings.</p>
                                        <p>If not, check that all the settings that you've provided are correct.</p>
                                        <div class="tip">
                                            <p>For further troubleshooting,  this <a href="https://sapphirenow.dev/post/wdc-oauth-part-2/">blog</a> might be helpful.</p>
                                        </div>
                                    </li>
                                </ol>
                            </li>
                            <li>
                                <p class="step"><span class="Emphasis">Authorize the OAuth2 authentication for the <MadCap:variable name="cc_product_vars.SCA-short" /> API</span>
                                </p>
                                <ol>
                                    <li>
                                        <p>In the <span class="Emphasis">Manage Authorizations</span> window, click <span class="Emphasis">New authorizations</span> and provide the <MadCap:variable name="cc_C_CyberArk.CompanyName" /> details:</p>
                                        <table style="mc-table-style: url('../Resources/TableStyles/Standard.css');caption-side: top;" class="TableStyle-Standard" cellspacing="0" summary="Lists the SCA API information that has to be applied to the authorization">
                                            <caption>SCA API authorization details</caption>
                                            <col class="TableStyle-Standard-Column-Column1" />
                                            <col class="TableStyle-Standard-Column-Column1" />
                                            <thead>
                                                <tr class="TableStyle-Standard-Head-Header1">
                                                    <th class="TableStyle-Standard-HeadE-Column1-Header1">
                                                        <p>Item</p>
                                                    </th>
                                                    <th class="TableStyle-Standard-HeadD-Column1-Header1">
                                                        <p>Description</p>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Name</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p>The OAuth2 server name</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Type</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p><span class="Emphasis">OAuth2</span>
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Flow</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p><span class="Emphasis">Client Credentials</span>
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Content Type</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p><span class="Emphasis">application/x-www-form-urlencoded</span>
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Client ID</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p>The username of your <MadCap:variable name="cc_product_vars.SCA-short" /> service user</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Client Secret</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p>The password of your&#160;<MadCap:variable name="cc_product_vars.SCA-short" /> service user</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                        <p><span class="Emphasis">Token URL</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                        <p><span class="Emphasis">https://<span class="Italics">&lt;<MadCap:variable name="cc_C_CyberArk.CompanyName" /> Identity tenant ID&gt;</span>/oauth2/token/<span class="Italics">&lt;authorization application id&gt;</span></span>
                                                        </p>
                                                        <p>For example, if your <MadCap:variable name="cc_C_CyberArk.CompanyName" /> Identity tenant ID is <span class="Emphasis">example.id.cyberark.cloud</span>, and your OAuth2 Server web app ID is <span class="Emphasis">myOAuthApp</span>, then the resulting Token URL&#160;would be</p>
                                                        <p><span class="Emphasis">https://example.id.cyberark.cloud/oauth2/token/myOAuthApp</span>
                                                        </p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Body1">
                                                    <td class="TableStyle-Standard-BodyB-Column1-Body1">
                                                        <p><span class="Emphasis">Scopes</span>
                                                        </p>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyA-Column1-Body1">
                                                        <p>Select <span class="Emphasis">Scopes</span>, and add <span class="Emphasis">sca</span></p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </li>
                                    <li>
                                        <p>Click <span class="Emphasis">Authorize</span>.

</p>
                                    </li>
                                    <li>
                                        <p>If the authentication is successful, save the settings.</p>
                                        <p>If not, check that all the settings that you've provided are correct, and try to authorize again.</p>
                                    </li>
                                </ol>
                            </li>
                        </ol>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot><a name="snow-flows"></a><MadCap:variable name="cc_C_CyberArk.CompanyName" /> admin: Set up the On-demand access flows</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <p>In this step, you import and configure the automated flows for requesting and granting on-demand access between <MadCap:variable name="cc_product_vars.SCA-short" /> and ServiceNow. </p>
                        <ol>
                            <li>
                                <p class="stepReset"><span class="Emphasis">Import the downloaded flows</span>
                                </p>
                                <p>In <MadCap:variable name="cc_product_vars.Flows-short" />, click <span class="Emphasis">+ Import</span> and import each of the flows that you downloaded at the beginning of this procedure:</p>
                                <ul>
                                    <li>
                                        <p><span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" /> Ondemand - ServiceNow Request.json</span>
                                        </p>
                                    </li>
                                    <li>
                                        <p><span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" /> Ondemand ServiceNow.json</span>
                                        </p>
                                    </li>
                                </ul>
                                <p>These flows work together as follows:</p>
                                <p>
                                    <img src="images/sca-snow-flows.png" class="Enlarge" />
                                </p>
                                <p>When a user requests access to their cloud console from their <MadCap:conditionalText MadCap:conditions="SCA-conditions.not-free-trial"><MadCap:variable name="cc_C_CyberArk.CompanyName" /> user portal</MadCap:conditionalText><MadCap:conditionalText MadCap:conditions="SCA-conditions.free-trial"><MadCap:variable name="cc_product_vars.SecureAccessSpace" /> space</MadCap:conditionalText>, this triggers the <span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" /> Ondemand - ServiceNow Request</span> flow to submit a request ticket in ServiceNow.</p>
                                <p>When ServiceNow sends an approval for the request, the second flow, <span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" /> Ondemand ServiceNow</span>, triggers <MadCap:variable name="cc_product_vars.SCA-short" /> to create the relevant <MadCap:variable name="cc_product_vars.SCA-short" /> access policy based on the requested access.</p>
                                <div class="note">
                                    <p><MadCap:variable name="cc_product_vars.SCA-short" /> uses the following APIs as part of on-demand access flows:</p>
                                    <ul>
                                        <li>
                                            <p><span class="Emphasis">Notification API</span> - sends request and approval messages by email during on-demand access flows.</p>
                                        </li>
                                        <li>
                                            <p><span class="Emphasis">SCA Policy API - Create Policy V2</span> - creates policies in <MadCap:variable name="cc_product_vars.SCA-short" /> as needed.</p>
                                        </li>
                                        <li>
                                            <p><span class="Emphasis">SCA Infrastructure API - Get Job Status</span> - gets the status of a job created by an asynchronous API call.</p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li>
                                <p class="step"><span class="Emphasis">Configure the on-demand request flow</span>
                                </p>
                                <ol>
                                    <li>
                                        <p>Open the <span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" /> Ondemand - ServiceNow Request</span> flow.</p>
                                    </li>
                                    <li>
                                        <p>Click the <span class="Emphasis">Create ServiceNow <MadCap:variable name="cc_product_vars.SCA-short" /> Request</span> node in the flow (the node with the ServiceNow logo):</p>
                                        <ol>
                                            <li>
                                                <p>In the <span class="Emphasis">Settings</span> tab on the right, under <span class="Emphasis">Authorizations</span>, select the ServiceNow authorization that you created in the previous step.</p>
                                            </li>
                                            <li>
                                                <p>In the <span class="Emphasis">Map</span> tab, configure the ServiceNow tenant:&#160;</p>
                                                <p>Click any field to open the pane on the left. </p>
                                                <p>Under <span class="Emphasis">Others &gt; Custom Values</span>, click the edit button next to <span class="Emphasis">servicenow-tenant</span>, and enter your ServiceNow tenant's ID.</p>
                                            </li>
                                        </ol>
                                    </li>
                                    <li>
                                        <p>Click the <span class="Emphasis">CyberArk</span> node in the flow, go to the <span class="Emphasis">Settings</span> tab on the right and, under <span class="Emphasis">Authorizations</span>, select the <MadCap:variable name="cc_C_CyberArk.CompanyName" /> OAuth2 authorization that you created earlier.</p>
                                    </li>
                                    <li>
                                        <p>Save the flow.</p>
                                    </li>
                                </ol>
                            </li>
                            <li>
                                <p class="step"><span class="Emphasis">Configure flow that triggers the creation of the SCA policy</span>
                                </p>
                                <ol>
                                    <li>
                                        <p>Open the <span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" /> Ondemand ServiceNow</span> flow. When this flow receives an approval from ServiceNow, it triggers <MadCap:variable name="cc_product_vars.SCA-short" /> to create an access policy.</p>
                                    </li>
                                    <li>
                                        <p>Click the <span class="Emphasis">CyberArk</span> node in the flow, go to the <span class="Emphasis">Settings</span> tab on the right and, under <span class="Emphasis">Authorizations</span>, select the <MadCap:variable name="cc_C_CyberArk.CompanyName" /> OAuth2 authorization that you created earlier.</p>
                                        <p>Repeat this for all of the other <MadCap:variable name="cc_C_CyberArk.CompanyName" /> nodes in this flow—altogether, there are five <MadCap:variable name="cc_C_CyberArk.CompanyName" /> nodes in this flow.</p>
                                    </li>
                                    <li>
                                        <p>Save the flow.</p>
                                    </li>
                                </ol>
                            </li>
                        </ol>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot>ServiceNow admin: Configure the <MadCap:variable name="cc_product_vars.SCA-short" /> app in ServiceNow<a name="Set"></a></MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <p>In this step, you configure the <MadCap:variable name="cc_product_vars.SCA-short" /> app that you installed earlier in ServiceNow.</p>
                        <div class="note">
                            <p>You must be a ServiceNow administrator to configure the <MadCap:variable name="cc_C_CyberArk.CompanyName" /><MadCap:variable name="cc_product_vars.SCA-short" /> app in the ServiceNow tenant.</p>
                        </div>
                        <ol>
                            <li>
                                <p>In the ServiceNow Catalog Overview page, go to <span class="Emphasis">All </span>&gt; <span class="Emphasis"><MadCap:variable name="cc_C_CyberArk.CompanyName" /><MadCap:variable name="cc_product_vars.SCA-short" /></span> &gt; <span class="Emphasis">Settings</span>.</p>
                            </li>
                            <li>
                                <p>Click <span class="Emphasis">New</span> and fill in the following fields:</p>
                                <table style="caption-side: top;mc-table-style: url('../Resources/TableStyles/Standard.css');" class="TableStyle-Standard" cellspacing="0" summary="The ServiceNow parameters that have to be configured">
                                    <caption>ServiceNow settings for SCA</caption>
                                    <col class="TableStyle-Standard-Column-Column1" style="width: 343px;" />
                                    <col class="TableStyle-Standard-Column-Column1" />
                                    <thead>
                                        <tr class="TableStyle-Standard-Head-Header1">
                                            <th class="TableStyle-Standard-HeadE-Column1-Header1">
                                                <p>Item</p>
                                            </th>
                                            <th class="TableStyle-Standard-HeadD-Column1-Header1">
                                                <p>Description</p>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="TableStyle-Standard-Body-Body1">
                                            <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                <p><span class="Emphasis"><MadCap:variable name="cc_C_CyberArk.CompanyName" /> <MadCap:variable name="cc_product_vars.Flows-short" /> tenant</span>
                                                </p>
                                            </td>
                                            <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                <p>The name of the <MadCap:variable name="cc_C_CyberArk.CompanyName" /> <MadCap:variable name="cc_product_vars.Flows-short" /> tenant:</p>
                                                <p><span class="Emphasis">&lt;tenant&gt;.flows.cyberark.cloud</span>
                                                </p>
                                                <div class="tip">
                                                    <p>This information is available in <MadCap:variable name="cc_product_vars.Flows-short" />, in the <span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" /> Ondemand - ServiceNow Request</span> flow's runtime settings, or from the URL in the address bar.</p>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr class="TableStyle-Standard-Body-Body1">
                                            <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                                <p><span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" /> flow name</span>
                                                </p>
                                            </td>
                                            <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                                <p>The name of the <MadCap:variable name="cc_product_vars.SCA-short" /> flow for ServiceNow in <MadCap:variable name="cc_product_vars.Flows-short" />: <span class="Emphasis">SCA Ondemand ServiceNow</span></p>
                                            </td>
                                        </tr>
                                        <tr class="TableStyle-Standard-Body-Body1">
                                            <td class="TableStyle-Standard-BodyB-Column1-Body1">
                                                <p><span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" /> flow API key</span>
                                                </p>
                                            </td>
                                            <td class="TableStyle-Standard-BodyA-Column1-Body1">
                                                <p>The API&#160;key for the <MadCap:variable name="cc_product_vars.SCA-short" /> flow for ServiceNow in <MadCap:variable name="cc_product_vars.Flows-short" />.</p>
                                                <div class="tip">
                                                    <p>The API key is available in <MadCap:variable name="cc_product_vars.Flows-short" />, in the <span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" /> Ondemand - ServiceNow</span> flow's runtime settings. </p>
                                                    <ol>
                                                        <li>
                                                            <p>Click the top node in the<span class="Emphasis"><MadCap:variable name="cc_product_vars.SCA-short" /> Ondemand - ServiceNow</span> flow.</p>
                                                        </li>
                                                        <li>
                                                            <p>On the right, under <span class="Emphasis">Settings</span>, select <span class="Emphasis">API&#160;access</span>, then select <span class="Emphasis">Key</span>.</p>
                                                        </li>
                                                    </ol>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </li>
                            <li>
                                <p>Submit your changes.</p>
                            </li>
                        </ol>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot><a name="Assign"></a>ServiceNow admin: Assign <MadCap:variable name="cc_product_vars.SCA-short" /> roles to ServiceNow users</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <div>
                            <p>The <MadCap:variable name="cc_product_vars.SCA-short" /> app for ServiceNow provides the following roles that you can assign to your ServiceNow users.</p>
                            <table style="caption-side: top;mc-table-style: url('../Resources/TableStyles/Standard.css');" class="TableStyle-Standard" cellspacing="0" summary="List of ServiceNow roles and their descriptions for the CyberArk SCA app">
                                <caption>ServiceNow user roles</caption>
                                <col class="TableStyle-Standard-Column-Column1" />
                                <col class="TableStyle-Standard-Column-Column1" />
                                <col class="TableStyle-Standard-Column-Column1" />
                                <thead>
                                    <tr class="TableStyle-Standard-Head-Header1">
                                        <th class="TableStyle-Standard-HeadE-Column1-Header1">
                                            <p>User</p>
                                        </th>
                                        <th class="TableStyle-Standard-HeadE-Column1-Header1">
                                            <p>Role</p>
                                        </th>
                                        <th class="TableStyle-Standard-HeadD-Column1-Header1">
                                            <p>Description</p>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="TableStyle-Standard-Body-Body1">
                                        <td class="TableStyle-Standard-BodyE-Column1-Body1" rowspan="2">
                                            <p><span class="Emphasis">Administrator</span>
                                            </p>
                                        </td>
                                        <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                            <p><span class="Emphasis">x_cya_cyberark_sca.sca_admin</span>
                                            </p>
                                        </td>
                                        <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                            <p>Grants administrator access to the integration and specifically the <span class="Emphasis">All Requests </span>option, so the ServiceNow administrator can see all the requests received by the app.</p>
                                        </td>
                                    </tr>
                                    <tr class="TableStyle-Standard-Body-Body1">
                                        <td class="TableStyle-Standard-BodyE-Column1-Body1">
                                            <p><span class="Emphasis">x_cya_cyberark_sca.cyberark_sca_settings_user</span>
                                            </p>
                                        </td>
                                        <td class="TableStyle-Standard-BodyD-Column1-Body1">
                                            <p>Grants access to the Settings page of the app, so the ServiceNow administrator can configure the integration between ServiceNow and <MadCap:variable name="cc_product_vars.SCA-short" />.</p>
                                        </td>
                                    </tr>
                                    <tr class="TableStyle-Standard-Body-Body1">
                                        <td class="TableStyle-Standard-BodyB-Column1-Body1">
                                            <p><span class="Emphasis">Basic</span>
                                            </p>
                                        </td>
                                        <td class="TableStyle-Standard-BodyB-Column1-Body1">
                                            <p><span class="Emphasis">x_cya_cyberark_sca.cyberark_sca_request_user</span>
                                            </p>
                                        </td>
                                        <td class="TableStyle-Standard-BodyA-Column1-Body1">
                                            <p>Grants access to the <span class="Emphasis">Incoming Requests</span> and <span class="Emphasis">My Requests</span> options. The view is filtered based on the current user, and shows requests submitted by the current user or incoming requests that must be approved by the current user.</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot><a name="Delegate"></a><MadCap:variable name="cc_C_CyberArk.CompanyName" /> admin: Delegate approvers for on-demand access requests</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <p>In this step you specify which ServiceNow users should receive and approve requests for on-demand access to a specific workspace.</p>
                        <div class="tip">
                            <p>This step is optional, but recommended, so that you can get the full value of the integration. By default, all CS Admins receive these requests.</p>
                        </div>
                        <p>In <MadCap:variable name="cc_product_vars.CEM-short" />:</p>
                        <ol>
                            <li>
                                <p>Go to <span class="Emphasis">Settings &gt; Workspace delegation</span>.</p>
                            </li>
                            <li>
                                <p>Select the workspace and delegate users to be the approvers of requests for that workspace.</p>
                            </li>
                        </ol>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot><a name="snow-verify"></a>CyberArk and ServiceNow admins:&#160;Verify the configuration</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <p>CyberArk and ServiceNow admins: In this step, you verify the <MadCap:variable name="cc_product_vars.SCA-short" /> - ServiceNow integration that you set up in the previous steps.</p>
                        <ol>
                            <li>
                                <p MadCap:conditions="SCA-conditions.not-free-trial">From the <MadCap:variable name="cc_product_vars.Identity-full" /> user portal, send an on-demand access request. For details, see <MadCap:xref href="../DPAforCloud/sca_request-temporary-access.htm">Request temporary access</MadCap:xref>.</p>
                                <p MadCap:conditions="SCA-conditions.free-trial">From the <MadCap:variable name="cc_product_vars.SecureAccessSpace" /> space, send an on-demand access request. For details, see <a href="/secure-access-space/latest/en/content/cloud-consoles/sca_request-temporary-access.htm">Request temporary access</a>.</p>
                            </li>
                            <li>
                                <p>In ServiceNow:</p>
                                <ol>
                                    <li>
                                        <p>Check the <span class="Emphasis">All requests</span> list to verify that ServiceNow received the request.</p>
                                    </li>
                                    <li>
                                        <p>In the <span class="Emphasis">Request state</span> area, accept or reject the request.</p>
                                    </li>
                                </ol>
                            </li>
                            <li>
                                <p>Verify that the requester receives an approval/rejection email.</p>
                            </li>
                        </ol>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot><a name="snow-verify"></a>CyberArk and ServiceNow admins:&#160;Select Manual or Automatic approval</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <MadCap:snippetBlock src="../CloudAdmin/CloudAdminSnippets/Automatic-Manual-Approval.flsnp" />
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
        </ol>
    </body>
</html>