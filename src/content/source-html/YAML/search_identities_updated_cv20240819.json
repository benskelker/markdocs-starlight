openapi: 3.0.0
info:
  title: CEM get identities API
  version: 1.0.0
  description: >-
    Retrieves a list of identities based on selected search parameters.
  contact:
    name: CEM
servers:
  - url: https://api.cem.cyberark.cloud/api
    description: >-
      CEM base URL
  - url: https://{identity_tenant}.my.identity.qa
    description: >-
      Identity base URL
components:
  securitySchemes:
    bearerOAuth:
      type: http
      scheme: bearer
      description: 'Bearer token authorization'
  schemas:
    paginationData:
      type: object
      properties:
        limit:
          type: integer
          description: >-
            The maximum number of items that can be returned for a single request. Can be considered as the page size. If no limit is specified, the default value is 15 results per request. The maximum value is 250.
        nextToken:
          type: string
          description: >-
            A token provided by the service as part of a response to a previous page call.
      description: >-
        Gets next search results page subject to the limit.
    filter:
      type: object
      properties:
        identityType:
          type: string
          enum:
            - AWS_IAM_USER
            - AWS_IAM_ROLE
            - AWS_IAM_GROUP
            - AWS_SSO_USER
            - AWS_SSO_GROUP
            - GCP_IAM_GROUP
            - GCP_IAM_SERVICE_ACCOUNT
            - GCP_IAM_GOOGLE_ACCOUNT
            - AZURE_USER
            - AZURE_GROUP
            - AZURE_APPLICATION
            - AZURE_MANAGED_IDENTITY
          description: >-
            Identity type. Supported values: AWS IAM user, AWS IAM role, AWS IAM group, AWS SSO (IDC) user, AWS SSO (IDC) group, Google Cloud IAM group,
            Google Cloud IAM service account, Google Cloud IAM Google account, Azure user, Azure group,
            Azure application, Azure managed identity.
            Any identity with a type equal to the provided value will be returned.
        name:
          type: string
          description: >-
            The name of the identity to filter on.
            Any identity with a name that contains the provided value will be returned.
        cloudProvider:
          type: string
          enum:
            - AWS
            - GCP
            - Azure
          description: >-
            The cloud provider name to filter on. Supported values: AWS, Google Cloud, Azure.
            Any identity with a cloud provider equal to the provided value will be returned.
        workspace:
          type: string
          description: >-
            The unique ID of the workspace to filter on.
            Any identity with a workspace equal to the provided value will be returned.
        admin:
          type: boolean
          description: >-
            Filter admin users of type admin only.
            Any identity with type admin will be returned.
      description: >-
        Filter on identities by type, cloud provider, workspace, admin, shadow admin, and exposure.
    request:
      type: object
      properties:
        paginationData:
          type: object
          items:
            $ref: '#/components/schemas/paginationData'
        filter:
          type: object
          items:
            $ref: '#/components/schemas/filter'
    identity:
      type: object
      properties:
        uid:
          type: string
          description: >-
            Identity Id.
        name:
          type: string
          description: >-
            The name of the identity.
        identity_type:
            type: string
            enum:
              - AwsIamUser
              - AwsIamRole
              - AwsIamGroup
              - AwsSsoUser
              - AwsSsoGroup
              - GcpIamGroup
              - GcpIamServiceAccount
              - GcpIamGoogleAccount
              - AzureUser
              - AzureGroup
              - AzureApplication
              - AzureManagedIdentity
            description: >-
              Identity type. Supported values: AWS IAM user, AWS IAM role, AWS IAM group, AWS SSO (IDC) user, AWS SSO (IDC) group, Google Cloud IAM group,
              Google Cloud IAM service account, Google Cloud IAM Google account, Azure user, Azure group,
              Azure application, Azure managed identity.
        number_of_workspaces:
          type: integer
          description: >-
            Number of workspaces where the identity has direct entitlements on.
        workspaces:
          type: array
          items:
           type: string
           description: List of workspace Ids.
        admin:
          type: boolean
          description: >-
            Filter on users of type admin only.
  responses:
    results:
      description: >-
        A list of identities that match the provided filter.
      content:
        application/json:
          schema:
            type: object
            properties:
              identities:
                type: array
                items:
                  $ref: '#/components/schemas/identity'
              next_token:
                type: string
                description: >-
                  A token used in the next call to the Search service, to fetch the next results page.
paths:
  /identities:
    post:
      tags:
        - Operations
      summary: Search identities
      security:
        - bearerOAuth: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/request'
      responses:
        '200':
          $ref: '#/components/responses/results'
        '500':
          description: Internal server error
      operationId: SearchIdentities
      description: "\t\nReturns a list of identities that match the requested filter."