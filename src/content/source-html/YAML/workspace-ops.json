openapi: 3.0.0
info:
  title: CEM workspace operations API
  version: 1.0.0
  description: >-
    Connecting, disconnecting, and deleting workspaces via public REST APIs.
  contact:
    name: CEM
servers:
  - url: https://api.cem.cyberark.cloud/api
    description: >-
      cem_base_url
  - url: https://{identity_tenant}.my.identity.qa
    description: >-
      identity_base_url
components:
  securitySchemes:
    bearerOAuth:
      type: http
      scheme: bearer
      description: ''
  schemas: 
    WorkspaceInputData:
      type: object
      properties:
        workspaceId:
          type: string
          description: ID of the workspace on which the operation is executed
        platformType:
          type: string
          enum: [aws, azure, gcp]
          description: Platform type
        hierarchyTreeLevel:
          type: string
          enum: [LEAF, NODE, ROOT]
          description: Hierarchy tree level of the workspace in an organization

    WorkspaceConnectDataResponse: 
      type: object
      properties: 
        num_of_leaves_to_connect: 
          type: integer
        num_of_connected_leaves: 
          type: integer

paths:
  /new_account/workspaces/connect:
    post:
      tags:
        - Operations
      summary: >-
        Connect a workspace
      security:
        - bearerOAuth: []
      requestBody:
        description: Workspace data for connection
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkspaceInputData'
      responses:
        '200':
          description: Connection successfully completed 
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/WorkspaceConnectDataResponse'
        '500':
          description: Internal Server Error
      operationId: connectWorkspace
      description: "\t\nConnect a workspace"
  /new_account/workspaces/disconnect:
    post:
      tags:
        - Operations
      summary: >-
        Disconnect a workspace
      security:
        - bearerOAuth: []
      requestBody:
        description: Workspace data for disconnection
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkspaceInputData'
      responses:
        '200':
          description: Disconnection successfully completed
        '500':
          description: Internal Server Error
      operationId: disconnectWorkspace
      description: "\t\nDisconnect a workspace"
  /new_account/workspaces/delete:
    post:
      tags:
        - Operations
      summary: >-
        Delete a workspace
      requestBody:
        description: Workspace data for deletion
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkspaceInputData'
      responses:
        '200':
          description: Deletion successfully completed
        '500':
          description: Internal Server Error
      operationId: deleteWorkspace
      description: "\t\nDelete a workspace"