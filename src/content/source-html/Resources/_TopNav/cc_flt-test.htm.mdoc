# FLTÂ test topic

::: code-line-numbers
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: test-app
      name: test-app
      namespace: test-app-namespace
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: test-app
      template:
        metadata:
          labels:
            app: test-app
          annotations:
            conjur.org/authn-identity: host/test-app
            conjur.org/container-mode: sidecar
            conjur.org/secrets-destination: file
            conjur.org/conjur-secrets-policy-path.test-app: secrets/
            conjur.org/conjur-secrets.test-app: |
              - admin-username: username
              - admin-password: password
            conjur.org/secret-file-path.test-app: "./credentials.yaml"
            conjur.org/secret-file-format.test-app: "yaml"
            conjur.org/secrets-refresh-enabled: "true"
            conjur.org/secrets-refresh-interval: 10m
        spec:
          serviceAccountName: test-app-sa
          containers:
          - name: test-app
            image: myorg/test-app
            volumeMounts:
              - name: conjur-secrets
                mountPath: /opt/secrets/conjur
                readOnly: true
          - name: cyberark-secrets-provider-for-k8s
            image: 'cyberark/secrets-provider-for-k8s:latest'
            imagePullPolicy: Always
            env:
            - name: MY_POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: MY_POD_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
            envFrom:
            - configMapRef:
                name: conjur-connect
            volumeMounts:
              - name: podinfo
                mountPath: /conjur/podinfo
              - name: conjur-secrets
                mountPath: /conjur/secrets
          volumes:
            - name: podinfo
              downwardAPI:
                items:
                  - path: "annotations"
                    fieldRef:
                      fieldPath: metadata.annotations
            - name: conjur-secrets
              emptyDir:
                medium: Memory
:::

::: code-line-numbers
    environment:
      k8sSecrets: [db-credentials]
      conjur:
        account: my-conjur-account
        applianceUrl: https://dap-follower.cyberark.svc.cluster.local
        authnUrl: https://dap-follower.cyberark.svc.cluster.local/authn-k8s/<authenticator-id>
        authnLogin:  host/secrets-provider-app
        sslCertificate:
          value: ""
:::
