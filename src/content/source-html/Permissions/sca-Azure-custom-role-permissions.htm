<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../Resources/TableStyles/Standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
    </head>
    <body>
        <h1>Azure permissions used by <MadCap:variable name="cc_product_vars.SCA-short" /> custom roles</h1>
        <p>This document describes the Azure permissions needed by <MadCap:variable name="cc_C_CyberArk.CompanyName" /> <MadCap:variable name="cc_product_vars.SCA-full" /> as part of the solution that removes the ability to grant access to <MadCap:variable name="cv-shared-variables.entra-id-long" /> (Azure AD) roles while maintaining the ability to grant access to Azure resource roles at the selected level.</p>
        <h2>App registration </h2>
        <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/Standard.css');" class="TableStyle-Standard" cellspacing="0" summary="list of specific permissions for app registration">
            <caption>Azure app registration permissions</caption>
            <col class="TableStyle-Standard-Column-Column1" />
            <col class="TableStyle-Standard-Column-Column1" />
            <col class="TableStyle-Standard-Column-Column1" />
            <thead>
                <tr class="TableStyle-Standard-Head-Header1">
                    <th class="TableStyle-Standard-HeadE-Column1-Header1">
                        <p>ID</p>
                    </th>
                    <th class="TableStyle-Standard-HeadE-Column1-Header1">
                        <p>Permission</p>
                    </th>
                    <th class="TableStyle-Standard-HeadD-Column1-Header1">
                        <p>Scope</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>1bfefb4e-e0b5-418b-a88f-73c46d2cc8e9</p>
                    </td>
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Application.ReadWrite.All</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Directory</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>19dbc75e-c2e2-444c-a770-ec69d8559fc7</p>
                    </td>
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Directory.ReadWrite.All</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Directory</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyB-Column1-Body1">
                        <p>9e3f62cf-ca93-4989-b6ce-bf83c28f9fe8</p>
                    </td>
                    <td class="TableStyle-Standard-BodyB-Column1-Body1">
                        <p>RoleManagement.ReadWrite.Directory</p>
                    </td>
                    <td class="TableStyle-Standard-BodyA-Column1-Body1">
                        <p>Directory</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3>Custom roles</h3>
        <p><span class="Emphasis">sca-aad-role </span>is assigned to the root management group, and currently doesn't have any permissions assigned.</p>
        <h2>Azure Resource</h2>
        <h3>App registration </h3>
        <div class="note">
            <p>Entra ID&#160;permissions are limited to the specified scope (management group or subscription).</p>
        </div>
        <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/Standard.css');" class="TableStyle-Standard" cellspacing="0" summary="list of specific permissions for Azure RBAC app registration">
            <caption>Azure RBAC app registration permissions</caption>
            <col class="TableStyle-Standard-Column-Column1" />
            <col class="TableStyle-Standard-Column-Column1" />
            <col class="TableStyle-Standard-Column-Column1" />
            <thead>
                <tr class="TableStyle-Standard-Head-Header1">
                    <th class="TableStyle-Standard-HeadE-Column1-Header1">
                        <p>ID</p>
                    </th>
                    <th class="TableStyle-Standard-HeadE-Column1-Header1">
                        <p>Permission</p>
                    </th>
                    <th class="TableStyle-Standard-HeadD-Column1-Header1">
                        <p>Scope</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>62a82d76-70ea-41e2-9197-370581804d09</p>
                    </td>
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Group.ReadWrite.All</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Resource</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>df021288-bdef-4463-88db-98f22de89214</p>
                    </td>
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>User.Read.All</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Resource</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>dbaae8cf-10b5-4b86-a4a1-f871c94c6695</p>
                    </td>
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>GroupMember.ReadWrite.All</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Resource</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyB-Column1-Body1">
                        <p>bf7b1a76-6e77-406b-b258-bf5c7720e98f</p>
                    </td>
                    <td class="TableStyle-Standard-BodyB-Column1-Body1">
                        <p>Group.Create</p>
                    </td>
                    <td class="TableStyle-Standard-BodyA-Column1-Body1">
                        <p>Resource</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3>Custom roles</h3>
        <ul>
            <li>
                <p>A privileged custom role must be assigned to the app registration to enable rotating secrets.</p>
                <p>This custom role needs the <span class="Emphasis">microsoft.directory/applications/credentials/update </span>permission assigned.</p>
            </li>
        </ul>
        <ul>
            <li>
                <p><span class="Emphasis">sca-resource-role </span>is assigned for the onboarded management group and/or subscriptions.</p>
            </li>
        </ul>
        <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/Standard.css');" class="TableStyle-Standard" cellspacing="0" summary="Azure RBAC custom role permissions">
            <caption>Permissions for custom role</caption>
            <col class="TableStyle-Standard-Column-Column1" />
            <col class="TableStyle-Standard-Column-Column1" />
            <thead>
                <tr class="TableStyle-Standard-Head-Header1">
                    <th class="TableStyle-Standard-HeadE-Column1-Header1">
                        <p>Permission</p>
                    </th>
                    <th class="TableStyle-Standard-HeadD-Column1-Header1">
                        <p>Used to...</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Authorization/roleAssignments/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get list of role assignments so that <MadCap:variable name="cc_product_vars.SCA-short" /> knows which assignments must be removed when a session is revoked</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Authorization/roleAssignments/write</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Add just-in-time role assignment</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Authorization/roleAssignments/delete</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Revoke just-in-time session</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Authorization/roleDefinitions/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get role definition's metadata</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Authorization/roleManagementPolicies/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get role policies so <MadCap:variable name="cc_product_vars.SCA-short" /> can present the relevant roles per selected resource</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Authorization/permissions/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get permission's metadata</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.ResourceGraph/operations/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Used to present the role details</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.ResourceGraph/resources/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get resource's metadata</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Resources/subscriptions/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get subscriptions</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Resources/subscriptions/resourceGroups/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get subscription's resource groups</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Resources/subscriptions/resourcegroups/resources/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get resource group's resources</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Resources/subscriptions/providers/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get Microsoft's registered providers</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Resources/subscriptions/resources/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get subscription's resources</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Resources/subscriptions/operationresults/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get subscription's metadata</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Resources/resources/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get resources</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyE-Column1-Body1">
                        <p>Microsoft.Management/managementGroups/read</p>
                    </td>
                    <td class="TableStyle-Standard-BodyD-Column1-Body1">
                        <p>Get management groups</p>
                    </td>
                </tr>
                <tr class="TableStyle-Standard-Body-Body1">
                    <td class="TableStyle-Standard-BodyB-Column1-Body1">
                        <p>Microsoft.Management/managementGroups/subscriptions/read	</p>
                    </td>
                    <td class="TableStyle-Standard-BodyA-Column1-Body1">
                        <p>Get management group's subscriptions</p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>