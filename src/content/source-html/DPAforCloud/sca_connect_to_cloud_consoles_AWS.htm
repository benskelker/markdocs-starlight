<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="SCA-conditions.not-free-trial">
    <head>
    </head>
    <body>
        <h1>Connect to AWS </h1>
        <p>This topic describes how to connect to AWS&#160;securely via <MadCap:variable name="cc_product_vars.SCA-short" />. You have two options for connecting, based on whether you want to elevate your privileges for this work session or use your current permissions.</p>
        <div class="important" MadCap:conditions="SCA-conditions.not-free-trial">
            <MadCap:snippetBlock src="SCA-snippets/intro-secure-access-space.flsnp" />
        </div>
        <div class="tabs">
            <ul class="tabs-nav">
                <li class="tab-active"><a data-cc-tab=".tab-1">AWS&#160;console</a>
                </li>
                <li><a data-cc-tab=".tab-2">AWS CLI</a>
                </li>
            </ul>
            <div class="tabs-stage">
                <div class="tab-1">
                    <p MadCap:conditions="cc_C_CyberArk.InternalOnly">Tab 1 Content - connect through Console</p>
                    <div class="note">
                        <p>If you want to connect  to the AWS console directly using your current permissions instead of one of the roles in roles list, click <span class="Emphasis">Go directly to the cloud console</span> at the top of the page.</p>
                    </div>
                    <div class="important">
                        <MadCap:snippetBlock src="SCA-snippets/popup-blocker.flsnp" />
                    </div>
                    <p class="ProcedureHeading">To connect to the AWS console:</p>
                    <ol>
                        <li>
                            <p>Sign in to <MadCap:variable name="cc_product_vars.ISP-full" />.</p>
                        </li>
                        <li>
                            <p>In the <span class="Emphasis"><MadCap:variable name="cc_C_CyberArk.CompanyName" /> User portal</span> &gt; <span class="Emphasis">Applications</span> page, click the relevant AWS&#160;web app tile.</p>
                        </li>
                        <li>
                            <p>Connect to your account:</p>
                            <div class="tabs">
                                <ul class="tabs-nav">
                                    <li class="tab-active"><a data-cc-tab=".tab-1">AWS IAM</a>
                                    </li>
                                    <li><a data-cc-tab=".tab-2"><MadCap:variable name="sca-project-variables.AWS-AD" /></a>
                                    </li>
                                </ul>
                                <div class="tabs-stage">
                                    <div class="tab-1">
                                        <p MadCap:conditions="cc_C_CyberArk.InternalOnly">Tab 1 Content - Console- AWS IAM</p>
                                        <p>A list of AWS accounts that you have access to is displayed, together with the roles you can connect with. </p>
                                        <p>Find the account you want to connect to, select the role you want to connect with, and click <span class="Emphasis">Connect</span>.</p>
                                        <p>The AWS&#160;console opens with all the privileges that the cloud role you selected entitles you to.</p>
                                    </div>
                                    <div class="tab-2">
                                        <p MadCap:conditions="cc_C_CyberArk.InternalOnly">Tab 2 Content - Console- IAM IDC</p>
                                        <ol MadCap:continue="true">
                                            <li>
                                                <p>In the AWS permission set page for your account, find the permission set that you want to use to connect to your AWS&#160;console and click <span class="Emphasis">Connect</span>.</p>
                                            </li>
                                            <li>
                                                <p>When you are redirected to AWS, click the AWS&#160;account card to view the account name with the permission set you selected.</p>
                                            </li>
                                            <li>
                                                <p>Click <span class="Emphasis">Management console</span> to open the AWS console with the privileges available based on the permission set you selected.</p>
                                            </li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ol>
                </div>
                <div class="tab-2">
                    <p MadCap:conditions="cc_C_CyberArk.InternalOnly">Tab 2 Content - connect with CLI</p>
                    <ol>
                        <li>
                            <p>Prerequisite: Make sure that the AWS CLI is installed.</p>
                            <div class="note">
                                <p>For AWS&#160;IAM Identity Center this must be at least AWS&#160;CLI&#160;v2.</p>
                            </div>
                        </li>
                        <li>
                            <p>The following use cases are supported:</p>
                            <div class="tabs">
                                <ul class="tabs-nav">
                                    <li class="tab-active"><a data-cc-tab=".tab-1">AWS IAM</a>
                                    </li>
                                    <li><a data-cc-tab=".tab-2">AWS&#160;IAM&#160;Identity Center </a>
                                    </li>
                                </ul>
                                <div class="tabs-stage">
                                    <div class="tab-1">
                                        <p MadCap:conditions="cc_C_CyberArk.InternalOnly">Tab 1 Content - CLI - AWS&#160;IAM</p>
                                    </div>
                                    <div class="tab-1">
                                        <ol>
                                            <li>
                                                <p>In the CyberArk User portal, click the AWS&#160;account you want to access via CLI.</p>
                                            </li>
                                            <li>
                                                <p>Select the AWS role you want to connect with and, at the end of the row, click <span class="Emphasis">Get CLI token</span>.</p>
                                            </li>
                                            <li>
                                                <p>In the windows that opens, copy the token, and paste it into your AWS credentials file.</p>
                                            </li>
                                        </ol>
                                        <p>You can now work in the AWS&#160;CLI with the account and permission set that you chose.</p>
                                        <div class="note">
                                            <p>Role chaining limits your AWS CLI role session to a maximum of one hour, regardless of what is defined in the <MadCap:variable name="cc_product_vars.SCA-short" /> access policy.</p>
                                        </div>
                                    </div>
                                    <div class="tab-2">
                                        <p MadCap:conditions="cc_C_CyberArk.InternalOnly">Tab 2 Content - CLI -IAM IDC</p>
                                        <p>In this step, you provide the AWS&#160;IAM Identity Center details in the AWS CLI, and complete the authentication and authorization flow through the <MadCap:variable name="cc_C_CyberArk.CompanyName" /> and AWS web interfaces. After the sign-in process is complete, you can perform your tasks in the CLI.</p>
                                        <ol>
                                            <li>
                                                <p>Authenticate to the AWS&#160;CLI:</p>
                                                <ol>
                                                    <li>
                                                        <p>Open the AWS&#160;CLI&#160;command line and do the following at each prompt:</p>
                                                    </li>
                                                    <li>
                                                        <p>Type <span class="Emphasis">aws configure sso</span>.</p>
                                                    </li>
                                                    <li>
                                                        <p>Enter the URL for the AWS&#160;IAM&#160;Identity Center workspace you want to access.</p>
                                                        <p>For example: <span class="Emphasis">https://d-xxxxx.awsapps.com/start/</span></p>
                                                    </li>
                                                    <li>
                                                        <p>Select the <MadCap:variable name="sca-project-variables.AWS-AD" /> region.</p>
                                                    </li>
                                                    <li>
                                                        <p>In the AWS authorization window, confirm your request.</p>
                                                        <p>AWS redirects you to <MadCap:variable name="cc_C_CyberArk.CompanyName" />.</p>
                                                    </li>
                                                </ol>
                                            </li>
                                            <li>
                                                <p>Sign in to the CyberArk user portal. </p>
                                            </li>
                                            <li>
                                                <p>Find the account you want to connect to, and select the permission set you want to connect with. At the end of the row, click <span class="Emphasis">Connect</span>.</p>
                                            </li>
                                            <li>
                                                <p>In the AWS&#160;prompt that opens, click <span class="Emphasis">Allow</span> to allow access to your AWS data.</p>
                                            </li>
                                        </ol>
                                        <p>You can now work in the AWS&#160;CLI with the account and permission set that you chose.</p>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ol>
                </div>
            </div>
        </div>
    </body>
</html>